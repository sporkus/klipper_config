
[gcode_macro FILAMENT_EJECT]
gcode:
    STATUS_HEATING
    M109 S220
    M83 ;E relative 
    G90
    G1 E-50 F300
    M104 S230
    TOOLHEAD_FRONT

[gcode_macro FILAMENT_LOAD]
gcode:
    {% set purge_x = printer['gcode_macro clean_nozzle'].purge_x|random()|float %}
    {% set purge_y = printer['gcode_macro clean_nozzle'].purge_y|float %}
    {% set purge_z = printer['gcode_macro clean_nozzle'].purge_z|float %}

    STATUS_HEATING
    M104 S230

    {% if "XYZ" not in printer.toolhead.homed_axes %}
    	G28
    {% endif %}
    G90
    G0 X{purge_x} Y{purge_y} Z15 F30000
    G0 Z{purge_z} F1800
    M109 S230
    M83 ;E relative 
    G1 E30 F300
    CLEAN_NOZZLE
    M104 S0
    STATUS_READY
